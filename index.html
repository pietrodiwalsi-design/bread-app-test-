<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Bread & Soup Specialist Master</title>
    <style>
        :root {
            --primary: #8d6e63;
            --dark: #4e342e;
            --accent: #ffa726;
            --soup-theme: #d32f2f;
            --search-theme: #546e7a;
            --bg: #fdf5e6;
            --glass: rgba(255, 255, 255, 0.98);
        }

        html, body { margin: 0; padding: 0; width: 100%; height: 100dvh; overflow: hidden; background-color: var(--bg); }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg) url('https://images.unsplash.com/photo-1509440159596-0249088772ff?q=80&w=1000') center/cover fixed; display: flex; justify-content: center; }
        .app-shell { width: 100%; max-width: 500px; height: 100dvh; background: var(--glass); backdrop-filter: blur(12px); display: flex; flex-direction: column; box-shadow: 0 0 30px rgba(0,0,0,0.2); }
        header { padding: env(safe-area-inset-top) 1rem 1rem 1rem; text-align: center; background: white; border-bottom: 1px solid #eee; font-weight: bold; flex-shrink: 0; }
        main { flex: 1; overflow-y: auto; padding: 1.2rem; padding-bottom: 90px; -webkit-overflow-scrolling: touch; }
        nav { position: absolute; bottom: 0; width: 100%; height: calc(75px + env(safe-area-inset-bottom)); background: white; display: flex; border-top: 1px solid #eee; padding-bottom: env(safe-area-inset-bottom); z-index: 10; }
        .nav-btn { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 0.7rem; color: #888; cursor: pointer; border: none; background: none; }
        .nav-btn.active { color: var(--primary); font-weight: bold; }
        .nav-btn span { font-size: 1.4rem; margin-bottom: 2px; }
        .card { background: white; border-radius: 12px; padding: 1rem; margin-bottom: 1rem; border-left: 6px solid var(--primary); box-shadow: 0 4px 10px rgba(0,0,0,0.05); text-align: left; }
        .card.soup { border-left-color: var(--soup-theme); }
        .card.general { border-left-color: var(--accent); }
        .img-hero { width: 100%; height: 200px; border-radius: 10px; object-fit: cover; margin-bottom: 1rem; background: #eee; }
        .info-block { background: #fafafa; padding: 1rem; border-radius: 10px; margin-bottom: 1rem; border: 1px solid #eee; font-size: 0.95rem; line-height: 1.6; }
        .pro-tip { background: #fff3e0; border-left: 4px solid var(--accent); padding: 1rem; border-radius: 8px; font-size: 0.9rem; margin-bottom: 1rem; }
        input { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 1rem; font-size: 1rem; }
        ol, ul { padding-left: 1.2rem; margin: 0.5rem 0; }
        li { margin-bottom: 0.5rem; }
    </style>
</head>
<body>

<div class="app-shell">
    <header id="view-title">Bread & Soup Specialist</header>
    <main id="app-view"></main>
    <nav>
        <button class="nav-btn" onclick="navigate('search')"><span>üåç</span>Search</button>
        <button class="nav-btn active" onclick="navigate('bread')"><span>üìü</span>Machine</button>
        <button class="nav-btn" onclick="navigate('general')"><span>ü•ñ</span>General</button>
        <button class="nav-btn" onclick="navigate('soup')"><span>ü•£</span>Soup</button>
        <button class="nav-btn" onclick="navigate('timer')"><span>‚è∞</span>Timer</button>
    </nav>
</div>

<script>
    const API_KEY = "2386c821382b4094a3045c9c6ffd588d";

    const MACHINE_DB = [
        { 
            name: "Basic White Bread", 
            img: "witbrood.png", 
            pairing: "Hearty Vegetable Beef Soup", 
            ingredients: ["1 tsp dry yeast", "500g strong white bread flour", "30g butter", "1.5 tbsp sugar", "1.5 tsp salt", "340ml water"], 
            instructions: ["Place yeast at the bottom of the pan.", "Cover with flour.", "Add butter, sugar, and salt.", "Pour water around the flour.", "Select Menu 1, Medium crust.", "Cool on a wire rack."], 
            tips: "Perfect for beginners. Use flour with at least 12% protein for best results." 
        },
        { 
            name: "Potato Rosemary Bread", 
            img: "aardappelbrood.png", 
            pairing: "Chicken Pot Pie Soup", 
            ingredients: ["1 tsp yeast", "400g spelt flour", "10g butter", "¬æ tsp sugar", "1¬æ tsp salt", "150g mashed potatoes (boiled & cooled)", "2 tbsp fresh rosemary (finely chopped)", "150ml water"], 
            instructions: ["Mash potatoes without milk/butter and let cool.", "Place yeast in the bread pan.", "Add flour, sugar, and salt.", "Add the mashed potatoes, rosemary, and water.", "Start Menu 1."], 
            tips: "The potato keeps the bread incredibly soft for several days." 
        },
        { 
            name: "Brioche (Classic)", 
            img: "brioche_brood.png", 
            pairing: "Roasted Tomato Soup", 
            ingredients: ["1.25 tsp yeast", "400g flour", "50g sugar", "1.5 tsp salt", "60g butter (cubed)", "2 eggs", "80g extra ice-cold butter (cubed)"], 
            instructions: ["Start Menu 10 with the first batch of butter.", "Cut the extra 80g butter into 1cm cubes and keep in the fridge.", "When the machine beeps (~55 mins), add the cold butter cubes.", "Select Light crust to prevent burning."], 
            tips: "Ice-cold butter cubes for the second stage are vital for texture." 
        },
        { 
            name: "French Bread", 
            img: "frans_stokbrood.png", 
            pairing: "Dutch Brown Bean Soup", 
            ingredients: ["1 tsp yeast", "400g white flour", "1.5 tsp salt", "290ml water"], 
            instructions: ["Place ingredients in the pan starting with yeast.", "Select Menu 11.", "This is a 6-hour cycle that develops flavor naturally."], 
            tips: "Contains no fat or sugar, resulting in a thin, crispy crust." 
        },
        { 
            name: "Whole Wheat", 
            img: "volkorenbrood.png", 
            pairing: "Lentil & Bacon Soup", 
            ingredients: ["1 tsp yeast", "400g whole wheat flour", "20g butter", "1 tbsp sugar", "1.5 tsp salt", "280ml water"], 
            instructions: ["Add ingredients to the pan.", "Select Menu 7.", "The machine includes a rest period to hydrate the bran."], 
            tips: "The longer rest period ensures the whole wheat isn't too dense." 
        },
        { 
            name: "Pizza Dough", 
            img: "pizza_deeg.png", 
            pairing: "Roasted Tomato Soup", 
            ingredients: ["1 tsp yeast", "450g flour", "4 tbsp oil", "2 tsp salt", "240ml water"], 
            instructions: ["Run Menu 23 (45 mins).", "Roll out on a tray dusted with semolina.", "Bake at 220¬∞C until edges are golden."], 
            tips: "Let the dough rest for 10 mins after the cycle for easier rolling." 
        },
        { 
            name: "Protein Bread (S)", 
            img: "proteine.png", 
            pairing: "Creamy Zucchini-Herb Soup", 
            ingredients: ["¬æ tsp yeast", "291g flour", "128g cottage cheese", "125g egg whites", "38g water", "5g smoked salt"], 
            instructions: ["Add liquid ingredients (egg whites, cottage cheese, water) first.", "Add dry ingredients and yeast.", "Run Menu 5."], 
            tips: "Small loaf; cottage cheese provides protein and moisture." 
        },
        { 
            name: "Cashew & Walnut Bread", 
            img: "notenbrood.png", 
            pairing: "Chickpea & Sweet Potato Soup", 
            ingredients: ["1 tsp yeast", "400g flour", "10g butter", "10g sesame", "280ml water", "150g mixed nuts"], 
            instructions: ["Place yeast, flour, and butter in pan.", "Add nuts to the dispenser or at the beep.", "Select Menu 3 (Raisin)."], 
            tips: "Toast the nuts briefly for a much deeper flavor." 
        },
        { 
            name: "Focaccia (Machine)", 
            img: "focaccia_brood.png", 
            pairing: "Minestrone", 
            ingredients: ["0.5 tsp yeast", "300g flour", "1 tbsp olive oil", "1 tsp salt", "170ml water"], 
            instructions: ["Run dough cycle.", "Remove and press into an oiled baking tray.", "Dimple the surface with fingers.", "Rise for 30 mins, then bake at 200¬∞C."], 
            tips: "Press dimples deep so the oil pools inside them." 
        },
        { 
            name: "Christmas Gingerbread", 
            img: "brioche_brood.png", 
            pairing: "Spicy Carrot Soup", 
            ingredients: ["3 ripe bananas", "170g flour", "2 eggs", "40ml oil", "100g dates", "50g molasses", "Gingerbread spices"], 
            instructions: ["Mix wet ingredients together.", "Add dry ingredients.", "Run Menu 15 (Cake).", "Scrape the sides of the pan after 2 mins mixing."], 
            tips: "Great as a sweet-savory pairing with spicy soups." 
        },
        { 
            name: "Panettone Style", 
            img: "panettone.png", 
            pairing: "None", 
            ingredients: ["7g yeast", "500g flour", "100g butter", "250ml milk", "1 egg + 2 yolks", "350g dried fruit"], 
            instructions: ["Warm milk/butter slightly.", "Add all except fruit to pan.", "Add fruit at the beep.", "Select Menu 3, Light crust."], 
            tips: "Rich dough; ensure yeast is fresh." 
        },
        { 
            name: "Crispy Herb Bread", 
            img: "frans_stokbrood.png", 
            pairing: "Hearty Vegetable Beef Soup", 
            ingredients: ["1 tbsp yeast", "500g flour", "1 tbsp salt", "Rosemary & Thyme", "260ml water"], 
            instructions: ["Run dough cycle in machine.", "Shape into an oval boule.", "Rise for 45 mins.", "Bake at 230¬∞C with steam."], 
            tips: "Steam is the secret to a professional crust." 
        },
        { 
            name: "Strawberry Jam", 
            img: "jam.png", 
            pairing: "None", 
            ingredients: ["300g strawberries", "200g sugar", "7g pectin"], 
            instructions: ["Chop fruit small.", "Place in pan with sugar and pectin.", "Run Menu 21.", "Jar while boiling hot."], 
            tips: "Remove kneading blade if your model requires it." 
        },
        { 
            name: "Fruit Compote", 
            img: "witbrood.png", 
            pairing: "None", 
            ingredients: ["400g fruit", "2 tbsp sugar", "1 tbsp water"], 
            instructions: ["Cut fruit into equal 2cm cubes.", "Run Menu 22.", "Perfect for topping yogurt."], 
            tips: "Try with a mix of apple and pear." 
        }
    ];

    const GENERAL_DB = [
        { 
            name: "Classic White Artisan Loaf", 
            img: "classic_white_artisan_loaf.png", 
            pairing: "Hearty Vegetable Beef Soup", 
            ingredients: ["500g white bread flour", "300ml lukewarm water", "7g dried yeast", "10g salt", "Splash of olive oil"], 
            instructions: ["Mix ingredients and knead until elastic.", "Let rise for 1 hour.", "Knock back and shape into a ball.", "Let rise again for 45-60 minutes.", "Bake at 220¬∞C for 30-35 minutes."], 
            tips: "Place a bowl of water in the oven for a crusty exterior." 
        },
        { 
            name: "Soft Milk Rolls", 
            img: "soft_milk_rolls.png", 
            pairing: "Chicken Pot Pie Soup", 
            ingredients: ["450g bread flour", "250ml lukewarm milk", "1 egg (beaten)", "30g butter", "1 tbsp sugar", "1 tsp salt", "1.25 tsp yeast"], 
            instructions: ["Knead dough and let rise.", "Divide into 8-10 pieces and shape into balls.", "Rise for 20-30 minutes.", "Brush with egg wash.", "Bake at 200¬∞C for 10-15 minutes."], 
            tips: "Milk creates a much softer crumb than water." 
        },
        { 
            name: "Focaccia", 
            img: "focaccia.png", 
            pairing: "Minestrone", 
            ingredients: ["300g bread flour", "170ml water", "1 tbsp olive oil", "1 tsp salt", "¬Ω tsp yeast"], 
            instructions: ["Knead dough.", "Roll out rectangle on baking tray.", "Dimple surface with fingers.", "Rise for 20-30 mins.", "Bake at 200¬∞C for 20-30 mins."], 
            tips: "Add rosemary and sea salt as toppings." 
        },
        { 
            name: "Naan Bread", 
            img: "naan_bread.png", 
            pairing: "Mulligatawny Soup", 
            ingredients: ["300g flour", "125ml natural yogurt", "1 tsp yeast", "1 tsp baking powder", "Garlic butter"], 
            instructions: ["Knead dough, rise 1 hour.", "Divide into balls, roll flat.", "Bake in hot dry frying pan 2 mins per side."], 
            tips: "Brush with garlic butter immediately after cooking." 
        },
        { 
            name: "French Stick (Baguette)", 
            img: "french_stick_baguette.png", 
            pairing: "Mulligatawny Soup", 
            ingredients: ["450g flour", "290ml water", "10g butter", "Yeast", "Salt"], 
            instructions: ["Rise, shape cylinders. Rise 50m.", "Score top diagonally.", "Bake at 220¬∞C with water spray."], 
            tips: "Water spray creates the crunchy crust." 
        },
        { 
            name: "Cheese & Onion Rolls", 
            img: "cheese_onion_rolls.png", 
            pairing: "Roasted Tomato Soup", 
            ingredients: ["White dough", "1 chopped onion", "100g grated cheese"], 
            instructions: ["Flatten dough balls.", "Top with onion and cheese.", "Bake at 200¬∞C for 20 mins."], 
            tips: "Saut√© the onion slightly beforehand." 
        },
        { 
            name: "Sunflower Seed Rolls", 
            img: "whole_wheat_sunflower_seed_rolls.png", 
            pairing: "Dutch Brown Bean Soup", 
            ingredients: ["Whole wheat flour", "300ml water", "Seeds"], 
            instructions: ["Divide into balls.", "Rise 40m.", "Bake at 200¬∞C for 25m."], 
            tips: "Substitute with pumpkin seeds." 
        },
        { 
            name: "Bagels", 
            img: "bagels.png", 
            pairing: "Creamy Zucchini-Herb Soup", 
            ingredients: ["450g flour", "250ml water", "Oil", "Yeast", "Sugar"], 
            instructions: ["Form rings, rise 30m.", "Boil 1m per side.", "Bake 200¬∞C 25m."], 
            tips: "Boiling creates the chewy texture." 
        },
        { 
            name: "Pita Bread", 
            img: "pita_bread.png", 
            pairing: "Chickpea & Sweet Potato Soup", 
            ingredients: ["300g flour", "180ml water", "Yeast"], 
            instructions: ["Roll thin discs.", "Bake at 240¬∞C for 5-8m until puffed."], 
            tips: "Do not overbake." 
        },
        { 
            name: "Hot Cross Buns", 
            img: "hot_cross_buns.png", 
            pairing: "Spicy Carrot Soup", 
            ingredients: ["475g flour", "Milk", "Fruit", "Spices", "Yeast"], 
            instructions: ["Divide 12 buns.", "Rise 30m.", "Pipe flour paste crosses.", "Bake 200¬∞C. Glaze while hot."], 
            tips: "Glaze with apricot jam." 
        },
        { 
            name: "Potato Bread (Rosemary)", 
            img: "potato_bread_with_rosemary.png", 
            pairing: "Spicy Carrot Soup", 
            ingredients: ["400g flour", "150g mashed potato", "Rosemary", "Water"], 
            instructions: ["Knead all, rise.", "Shape round boule.", "Bake 210¬∞C 35m."], 
            tips: "Stays soft for days." 
        },
        { 
            name: "Steamed Buns (Bapao)", 
            img: "steamed_buns_broodje_bapao.png", 
            pairing: "Mulligatawny Soup", 
            ingredients: ["250g flour", "Yeast", "150ml milk", "Meat/Veg filling"], 
            instructions: ["Fill balls, fold, rise 20m.", "Steam in bamboo basket 12m."], 
            tips: "Use parchment paper underneath." 
        },
        { 
            name: "Crusty Herb Bread", 
            img: "crusty_bread_with_rosemary_thyme.png", 
            pairing: "Hearty Vegetable Beef Soup", 
            ingredients: ["500g flour", "300ml water", "Herbs"], 
            instructions: ["Knead 20m, rise 1.5h.", "Score top.", "Bake at 230¬∞C."], 
            tips: "Steam is vital for crust." 
        },
        { 
            name: "Keto Yeast Bread", 
            img: "keto_low_carb_yeast_bread.png", 
            pairing: "Creamy Zucchini-Herb Soup", 
            ingredients: ["Wheat gluten", "Soy flour", "Warm water", "Yeast"], 
            instructions: ["Knead well (rubbery dough).", "Rise 90m.", "Bake 175¬∞C."], 
            tips: "Gluten provides the structure." 
        },
        { 
            name: "Easter Bunny Rolls", 
            img: "easter_bunny_rolls.png", 
            pairing: "Chicken Pot Pie Soup", 
            ingredients: ["450g flour", "Milk", "Butter", "Sugar", "Cinnamon"], 
            instructions: ["Fill dough, slice.", "Form ears.", "Bake 190¬∞C."], 
            tips: "Kids love these." 
        },
        { 
            name: "Six-Seed Small Loaf", 
            img: "six_seed_small_loaf.png", 
            pairing: "Dutch Brown Bean Soup", 
            ingredients: ["250g wholemeal", "Seeds", "Honey"], 
            instructions: ["Toast seeds.", "Knead, shape boule.", "Bake 200¬∞C."], 
            tips: "Toasting seeds adds depth." 
        },
        { 
            name: "Tomato & Parmesan Bread", 
            img: "tomato_parmesan_bread.png", 
            pairing: "Roasted Tomato Soup", 
            ingredients: ["500g flour", "Sundried tomatoes", "Parmesan"], 
            instructions: ["Add tomatoes/cheese at end of kneading.", "Bake 200¬∞C."], 
            tips: "Savory Italian flavor." 
        },
        { 
            name: "GF Christmas Bread", 
            img: "gluten_free_christmas_bread_with_nuts.png", 
            pairing: "Chicken Pot Pie Soup", 
            ingredients: ["Rice flour", "Potato starch", "Psyllium", "Nuts"], 
            instructions: ["Mix wet/dry. Fold in nuts.", "Rise 50m. Bake 190¬∞C."], 
            tips: "Psyllium husk binds the dough." }
    ];

    const SOUP_DB = [
        { 
            name: "Hearty Vegetable Beef Soup", 
            img: "hearty_vegetable_beef_soup.png", 
            pairing: "Classic White Artisan Loaf", 
            ingredients: ["4 oz butter", "2 lb mirepoix (onions, carrots, celery)", "6 oz turnip", "4 garlic cloves", "3 qt beef broth", "1 lb beef (small dice)", "2 bay leaves, ¬Ω tsp thyme, ¬Ω tsp peppercorns", "6 oz green beans", "6 oz tomato concass√©e", "6 oz corn", "Fresh oregano & thyme"], 
            instructions: ["Sweat mirepoix and turnip in butter until tender.", "Add garlic, saut√© lightly, then add beef broth and beef.", "Simmer with sachet for ~1 hour until beef is tender.", "Add green beans, tomatoes, corn, and fresh herbs.", "Simmer for another 15 minutes."], 
            tips: "Shred turnip tops or arugula and stir in near the end for extra nutrition." 
        },
        { 
            name: "Chicken Pot Pie Soup (Creamy)", 
            img: "chicken_pot_pie_soup.png", 
            pairing: "Soft Milk Rolls", 
            ingredients: ["Chicken (diced)", "Mirepoix", "4 tbsp butter", "4 tbsp flour", "Chicken stock", "Cubed potatoes", "Cream", "Peas/Corn", "Thyme"], 
            instructions: ["Saut√© mirepoix and chicken until cooked.", "Add butter, whisk in flour to make a roux; cook 1 min.", "Add stock and potatoes. Simmer until tender.", "Season and stir in cream (do not boil once cream is added)."], 
            tips: "If the soup is too thin, use a cornstarch slurry to thicken." 
        },
        { 
            name: "Dutch Brown Bean Soup", 
            img: "dutch_brown_bean_soup.png", 
            pairing: "French Stick (Baguette)", 
            ingredients: ["500 g dried brown beans", "1 onion", "2 celery stalks", "1 leek", "2 potatoes", "1 beef shank", "1.5 liters water", "2 beef bouillon cubes", "1 bay leaf", "1 smoked sausage (rookworst)"], 
            instructions: ["Soak beans overnight.", "Saut√© onion, celery, and leek until glazed.", "Add water, beef shank, bouillon, potatoes, and beans.", "Simmer for 1.5 hours.", "Add sliced sausage in last 20 mins."], 
            tips: "Better the next day. Pur√©e a portion of the beans for extra starchiness." 
        },
        { 
            name: "Mulligatawny Soup", 
            img: "mulligatawny_soup.png", 
            pairing: "Naan Bread", 
            ingredients: ["4 oz butter", "3 lb mirepoix", "3 oz flour", "2 tbsp curry powder", "2 qt chicken stock", "1 lb cooked chicken", "4 oz green apple", "4 oz mushrooms", "1 pt warm half-and-half"], 
            instructions: ["Saut√© mirepoix in butter for 10 mins without browning.", "Stir in flour and curry powder to form a roux.", "Add stock and simmer 15 mins.", "Add diced chicken, apple, and mushrooms. Cook 15 mins.", "Stir in warm cream."], 
            tips: "Serve over a small mound of rice for a full meal." 
        },
        { 
            name: "Minestrone (Rich Italian)", 
            img: "minestrone.png", 
            pairing: "Focaccia", 
            ingredients: ["2 tbsp olive oil", "Mirepoix", "200g green beans", "100g kidney beans", "1L veg stock", "175g pasta", "Parmesan"], 
            instructions: ["Saut√© mirepoix for 10 mins.", "Add beans, stock, and pasta.", "Simmer until pasta is tender.", "Garnish with basil and Parmesan."], 
            tips: "A hearty classic meant for dipping." 
        },
        { 
            name: "Spicy Carrot Soup", 
            img: "spicy_carrot.png", 
            pairing: "Potato Rosemary Bread", 
            ingredients: ["650g carrots", "1 red onion", "2 cloves garlic", "2 tbsp spices (cumin, coriander)", "1L stock", "Yogurt"], 
            instructions: ["Toast spices for 2 mins.", "Saut√© onion/garlic, then add carrots and stock.", "Simmer 25 mins.", "Blend smooth and swirl in yogurt."], 
            tips: "Toasting the spices first is essential for flavor." 
        },
        { 
            name: "Creamy Zucchini-Herb Soup", 
            img: "zucchini_herb.png", 
            pairing: "Bagels", 
            ingredients: ["800g zucchini", "Spring onion", "Herbs (basil, parsley)", "Cream cheese", "Stock"], 
            instructions: ["Simmer veg for 15m.", "Blend until smooth.", "Stir in cream cheese while hot."], 
            tips: "Use less stock than other soups; zucchini is very wet." 
        },
        { 
            name: "Creamy Mustard Soup", 
            img: "creamy_mustard.png", 
            pairing: "Basic White Bread", 
            ingredients: ["Leek", "Potato", "Mustard", "Cream", "Butter"], 
            instructions: ["Fry leek/potato in butter.", "Simmer with stock and mustard for 15m.", "Puree and add cream."], 
            tips: "Use coarse Groninger mustard for texture." 
        },
        { 
            name: "Chickpea & Sweet Potato", 
            img: "chickpea_sweet_potato.png", 
            pairing: "Pita Bread", 
            ingredients: ["Chickpeas", "Sweet potato", "Red pepper", "Lime juice", "Stock"], 
            instructions: ["Simmer all for 20m.", "Puree smooth.", "Finish with lime juice."], 
            tips: "Potato starch makes it naturally creamy." 
        },
        { 
            name: "Roasted Tomato Soup", 
            img: "roasted_tomato.png", 
            pairing: "Tomato & Parmesan Bread", 
            ingredients: ["Tomatoes", "Balsamic vinegar", "Red pepper", "Basil", "Stock"], 
            instructions: ["Saut√© veg.", "Deglaze with balsamic.", "Simmer with tomatoes and stock for 15m.", "Blend with fresh basil."], 
            tips: "Balsamic balances the acidity of the tomatoes." 
        }
    ];

    const view = document.getElementById('app-view');
    const viewTitle = document.getElementById('view-title');

    function navigate(target) {
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        const activeBtn = document.querySelector(`.nav-btn[onclick="navigate('${target}')"]`);
        if(activeBtn) activeBtn.classList.add('active');
        view.innerHTML = ""; view.scrollTo(0,0);

        switch(target) {
            case 'search': renderSearch(); break;
            case 'bread': renderList(MACHINE_DB, 'bread'); break;
            case 'general': renderList(GENERAL_DB, 'general'); break;
            case 'soup': renderList(SOUP_DB, 'soup'); break;
            case 'timer': renderTimer(); break;
        }
    }

    function renderList(db, type) {
        const titles = { bread: "Panasonic Machine", general: "General Oven Bread", soup: "Soup Specialist" };
        viewTitle.innerText = titles[type];
        db.forEach((item) => {
            const card = document.createElement('div');
            card.className = `card ${type}`;
            card.innerHTML = `<div style="font-weight:bold; display:flex; justify-content:space-between; align-items:center;">${item.name} <span>‚ûú</span></div>`;
            card.onclick = () => renderDetail(item, type);
            view.appendChild(card);
        });
    }

    function renderDetail(item, type) {
        const pairingIcon = (type === 'soup') ? 'ü•ñ' : 'ü•£';
        view.innerHTML = `
            <button onclick="navigate('${type}')" style="background:none; border:none; color:#888; margin-bottom:1rem; cursor:pointer; font-weight:bold;">‚¨Ö BACK</button>
            ${item.pairing && item.pairing !== 'None' ? `<div style="background:#f1f8e9; padding:12px; border-radius:8px; margin-bottom:15px; color:#2e7d32; font-weight:bold; font-size:0.85rem;">${pairingIcon} PAIRS WITH: ${item.pairing}</div>` : ''}
            <img src="${item.img}" class="img-hero" onerror="this.src='https://via.placeholder.com/450x200?text=${item.name}'">
            <h2 style="margin:0;">${item.name}</h2>
            ${item.program ? `<div class="info-block"><strong>Method/Program:</strong> ${item.program}</div>` : ''}
            <div class="info-block"><strong>Ingredients:</strong><ul>${item.ingredients.map(i => `<li>${i}</li>`).join('')}</ul></div>
            ${item.toppings ? `<div class="info-block"><strong>Toppings:</strong> ${item.toppings}</div>` : ''}
            <div class="info-block"><strong>Instructions:</strong><ol>${item.instructions.map(step => `<li>${step}</li>`).join('')}</ol></div>
            <div class="pro-tip"><strong>Expert Tips:</strong><br>${item.tips}</div>
        `;
        view.scrollTo(0,0);
    }

    function renderTimer() {
        viewTitle.innerText = "Panasonic Timer";
        view.innerHTML = `<div class="info-block"><p>Current Time:</p><input type="time" id="t1" value="${new Date().toTimeString().slice(0,5)}"><p>Ready At:</p><input type="time" id="t2"><button class="card" style="width:100%; background:var(--dark); color:white; border:none; margin-top:10px; padding:15px;" onclick="calculate()">CALCULATE</button></div><div id="res" class="info-block" style="display:none; text-align:center; font-size:1.8rem; background:#e8f5e9;"></div>`;
    }

    function calculate() {
        const t1 = document.getElementById('t1').value.split(':'), t2 = document.getElementById('t2').value.split(':');
        let d1 = new Date(0,0,0,t1[0],t1[1]), d2 = new Date(0,0,0,t2[0],t2[1]);
        if (d2 <= d1) d2.setDate(d2.getDate() + 1);
        let diff = d2 - d1;
        const res = document.getElementById('res'); res.style.display = "block";
        res.innerHTML = `Set to: <strong>${Math.floor(diff/3600000)}:${new Date(diff).getUTCMinutes().toString().padStart(2,'0')}</strong>`;
    }

    function renderSearch() {
        viewTitle.innerText = "Global Search";
        view.innerHTML = `<input type="text" id="qs" placeholder="Search world recipes..."><button class="card" style="width:100%; background:var(--search-theme); color:white; border:none; padding:15px;" onclick="apiSearch()">üîç SEARCH ONLINE</button><div id="api-res"></div>`;
    }

    async function apiSearch() {
        const q = document.getElementById('qs').value || 'bread';
        const resDiv = document.getElementById('api-res'); resDiv.innerHTML = "Searching...";
        try {
            const r = await fetch(`https://api.spoonacular.com/recipes/complexSearch?query=${q}&number=8&apiKey=${API_KEY}`);
            const data = await r.json();
            resDiv.innerHTML = data.results.map(i => `<div class="card" onclick="fetchApiDetail(${i.id})"><b>${i.title}</b></div>`).join('');
        } catch(e) { resDiv.innerHTML = "API error."; }
    }

    async function fetchApiDetail(id) {
        view.innerHTML = "Loading...";
        const r = await fetch(`https://api.spoonacular.com/recipes/${id}/information?apiKey=${API_KEY}`);
        const data = await r.json();
        renderDetail({ name: data.title, img: data.image, ingredients: data.extendedIngredients.map(i => i.original), instructions: [data.instructions.replace(/<[^>]*>?/gm, '')], tips: "External source." }, 'search');
    }

    navigate('bread');
</script>
</body>
</html>
